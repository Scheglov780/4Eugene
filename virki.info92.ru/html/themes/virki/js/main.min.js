scripts=document.getElementsByTagName("script");thisFilePath=scripts[scripts.length-1].src.split("?")[0];var themePath=thisFilePath.split("/").slice(0,-2).join("/");delete scripts;delete thisFilePath;function dsAlert(c,b,a){if((c!=undefined)&&(c.length>0)){if(!a){alert(c)}else{bootbox.dialog({message:c,title:b,buttons:{success:{label:"OK",className:"btn-default",callback:function(){}}}})}}}function dsConfirm(c,b,a){if((c!=undefined)&&(c.length>0)){if(!a){return confirm(c)}else{return confirm(c)}}}function dsProgress(b,a){if((b!=undefined)&&(b.length>0)){bootbox.dialog({message:"<div class='img-loader'>"+b+"<img src='"+themePath+"/images/Hourglass.png' style='width: 160px; height: 160px;'></div>",title:a,closeButton:false})}}$(document).ready(function(){enableOnlineTranslationsEditing()});function loadCatalogMenu(c,b){var a=$("#menuMega");if(a.length>0){$.ajax({url:"//data."+document.domain+"/category/menu/lang/"+c+"/topLevelCount/"+b,cache:true,xhrFields:{withCredentials:true},dataType:"html",success:function(d){a.html(d)}})}}function enableOnlineTranslationsEditing(){var a=$("translation[editable=1]");if(a.length>0){console.log("Online translation editing enabled");$(a).each(function(){$(this).on("contextmenu",function(b){b.preventDefault();return false});$(this.parentNode).on("contextmenu",function(b){b.preventDefault();return false});$(this).mousedown(function(d){if(d.which==3){var c=$(this).attr("type");var b=$(this).attr("id");console.log("Online translation: "+b);b=b.replace(c,"");var g=b.replace(/([\d\-]+).+/i,"$1");var f=b.replace(/[\d\-]+(.+)/i,"$1");editTranslation(d,this,c,g,f);stopPropagation(d);return false}return true})})}}function editTranslation(j,c,g,b,d){var e=$(c).attr("url");var i=$(c).attr("to");var k=$(c).attr("pinned");var l=b.replace(/-.*/i,"");var f=d.replace(/-.*/i,"");var a=e+"?type="+g+"&id="+l+"&mode="+f+"&language="+i;if(a[0]!="/"){a=window.location.protocol+"//"+a}$("#TranslateForm_type").val(g);if(k){$("#TranslateForm_pinned").attr("value","1");$("#TranslateForm_pinned").prop("checked",true)}else{$("#TranslateForm_pinned").attr("value","0");$("#TranslateForm_pinned").prop("checked",false)}$("#TranslateForm_mode").val(d);$("#TranslateForm_id").val(b);var h=$(c).attr("from");$("#TranslateForm_from").val(h);$("#TranslateForm_to").val(i);$("#TranslateForm_url").val(a);$.getJSON(a,function(o){if((o!==null)&&(o!==undefined)&&(o.source!="")){$("#TranslateForm_source").val(o.source);$("#TranslateForm_message").val(o.message);var n=$("#translate-bkrs");if(n.length){if(h=="zh"){var m="https://bkrs.info/slovo.php?ch="+o.source}else{var m="https://bkrs.info/slovo.php?"+h+"="+o.source}n.attr("src",m)}$("#translationDialog").modal("show");if(j){stopPropagation(j)}}else{dsAlert("Перевод не найден!","",true)}});return false}function saveTranslation(){document.cookie="reset-translations-cache=true";var d=$("#TranslateForm_type").val()+$("#TranslateForm_id").val()+$("#TranslateForm_mode").val();var f=$("#TranslateForm_message").val();var a=d.replace(/-.*/i,"");console.log("Online translation mask: "+a);$('[id^="'+a+'"]').each(function(){$(this).text(f)});$("#TranslateForm_id").val($("#TranslateForm_id").val().replace(/-.*/i,""));$("#TranslateForm_mode").val($("#TranslateForm_mode").val().replace(/-.*/i,""));var c=$("#translation-form").serialize();var b=$("#TranslateForm_url").val();try{var e=b.replace(/^http[s]*:\/\/[a-z0-9\-\.:]+\//i,"/");$.post(e,c)}finally{$.post(b,c,function(){console.log("Online translation saved: "+d)});$("#translationDialog").modal("hide");return false}}function stopPropagation(a){var b;if(a){b=a}else{b=window.event}if(b.stopPropagation){b.stopPropagation()}if(b.cancelBubble!=null){b.cancelBubble=true}}function addParameterToUrl(a,h,d,b){replaceDuplicates=true;if(a.indexOf("#")>0){var j=a.indexOf("#");urlhash=a.substring(a.indexOf("#"),a.length)}else{urlhash="";j=a.length}sourceUrl=a.substring(0,j);var c=sourceUrl.split("?");var f="";if(c.length>1){var k=c[1].split("&");for(var e=0;(e<k.length);e++){var g=k[e].split("=");if(!(replaceDuplicates&&g[0]==h)){if(f==""){f="?"}else{f+="&"}f+=g[0]+"="+(g[1]?g[1]:"")}}}if(f==""){f="?"}if(b){f="?"+h+"="+d+(f.length>1?"&"+f.substring(1):"")}else{if(f!==""&&f!="?"){f+="&"}f+=h+"="+(d?d:"")}return c[0]+f+urlhash}function convertCurrency(c,d,e){var a="/site/convertCurrency?sum="+c+"&src="+d+"&dst="+e;var b=$.ajax({url:a,global:false,type:"GET",data:null,dataType:"text",async:false,success:function(f){console.log("Currency converted: "+f)}}).responseText;return b}function newsConfirm(a,c){var b=$(a).attr("href");if(typeof b=="undefined"){b=$(a).attr("formaction")}$.get(b,null,function(d){$("#news-confirm-button-"+c).tooltip("hide");$("#news-confirm-button-"+c).remove();dsAlert(d,"Подтверждение",true)},"text")}function fixYandexMapScroll(b){var a=b;var c=document.createElement("div");c.className="mapTitle";c.textContent="Для активации карты нажмите по ней";a.appendChild(c);$(a).on("click",function(){this.children[0].removeAttribute("style");if($(c.parentElement).length>0){c.parentElement.removeChild(c)}});$(a).on("mousemove",function(d){c.style.display="block";if(d.offsetY>10){c.style.top=d.offsetY+20+"px"}if(d.offsetX>10){c.style.left=d.offsetX+20+"px"}});$(a).on("mouseleave",function(){c.style.display="none"})};