(function(e){var d,b,c={},a=[];d=function(f){var g=a[f],h=e("#"+f).find("."+g.tableClass);h.children("tbody").find("input.select-on-check").filter(":checked").each(function(){e(this).closest("tr").addClass("selected")});h.children("thead").find("th input").filter('[type="checkbox"]').each(function(){var i=this.name.substring(0,this.name.length-4)+"[]",j=e("input[name='"+i+"']",h);this.checked=j.length>0&&j.length===j.filter(":checked").length});return this};b={init:function(f){var g=e.extend({ajaxUpdate:[],ajaxVar:"ajax",ajaxType:"GET",csrfTokenName:null,csrfToken:null,pagerClass:"pager",loadingClass:"loading",filterClass:"filters",tableClass:"items",selectableRows:1},f||{});g.tableClass=g.tableClass.replace(/\s+/g,".");return this.each(function(){var j,l,i=e(this),n=i.attr("id"),k="#"+n+" ."+g.pagerClass.replace(/\s+/g,".")+" a",h="#"+n+" ."+g.tableClass+" thead th a.sort-link";var m="#"+n+" .tableFloatingHeaderOriginal ."+g.filterClass+" input, "+"#"+n+" .tableFloatingHeaderOriginal ."+g.filterClass+" select";if(e(m).length<=0){m="#"+n+" ."+g.filterClass+" input, "+"#"+n+" ."+g.filterClass+" select"}g.updateSelector=g.updateSelector.replace("{page}",k).replace("{sort}",h);g.filterSelector=g.filterSelector.replace("{filter}",m);a[n]=g;if(g.ajaxUpdate.length>0){e(document).off("click.yiiGridView",g.updateSelector).on("click.yiiGridView",g.updateSelector,function(){if(g.enableHistory&&window.History.enabled){var o=e(this).attr("href");if(o){var p=o.split("?"),r=e.deparam.querystring("?"+(p[1]||""));delete r[g.ajaxVar];var q=e.param.querystring(p[0],r);window.History.pushState({url:q},document.title,q)}}else{e("#"+n).yiiGridView("update",{url:e(this).attr("href")})}return false})}e(document).off("change.yiiGridView keydown.yiiGridView",g.filterSelector).on("change.yiiGridView keydown.yiiGridView",g.filterSelector,function(p){if(p.type==="keydown"){if(p.keyCode!==13){return}else{j="keydown";l=p.target}}else{if(j==="keydown"&&l===p.target){j="";l=null;return}}var r=e(g.filterSelector).serialize();if(g.pageVar!==undefined){r+="&"+g.pageVar+"=1"}if(g.enableHistory&&g.ajaxUpdate!==false&&window.History.enabled){var o=e("#"+n).yiiGridView("getUrl"),s=e.deparam.querystring(e.param.querystring(o,r));delete s[g.ajaxVar];var q=e.param.querystring(o.substr(0,o.indexOf("?")),s);window.History.pushState({url:q},document.title,q)}else{e("#"+n).yiiGridView("update",{data:r})}return false});if(g.enableHistory&&g.ajaxUpdate!==false&&window.History.enabled){e(window).bind("statechange",function(){var o=window.History.getState();if(o.data.url===undefined){o.data.url=o.url}e("#"+n).yiiGridView("update",o.data)})}if(g.selectableRows>0){d(this.id);e(document).off("click.yiiGridView","#"+n+" ."+g.tableClass+" > tbody > tr").on("click.yiiGridView","#"+n+" ."+g.tableClass+" > tbody > tr",function(t){var s,p,r,q,o=e(t.target);if(o.closest("td").is(".empty,.button-column")||(t.target.type==="checkbox"&&!o.hasClass("select-on-check"))){return}p=e(this);s=e("#"+n);q=e("input.select-on-check",s);r=p.toggleClass("selected").hasClass("selected");if(g.selectableRows===1){p.siblings().removeClass("selected");q.prop("checked",false).trigger("change")}e("input.select-on-check",p).prop("checked",r).trigger("change");e("input.select-on-check-all",s).prop("checked",q.length===q.filter(":checked").length);if(g.selectionChanged!==undefined){g.selectionChanged(n)}});if(g.selectableRows>1){e(document).off("click.yiiGridView","#"+n+" .select-on-check-all").on("click.yiiGridView","#"+n+" .select-on-check-all",function(){var r=e("#"+n),q=e("input.select-on-check",r),o=e("input.select-on-check-all",r),p=r.find("."+g.tableClass).children("tbody").children();if(this.checked){p.addClass("selected");q.prop("checked",true).trigger("change");o.prop("checked",true)}else{p.removeClass("selected");q.prop("checked",false).trigger("change");o.prop("checked",false)}if(g.selectionChanged!==undefined){g.selectionChanged(n)}})}}else{e(document).off("click.yiiGridView","#"+n+" .select-on-check").on("click.yiiGridView","#"+n+" .select-on-check",false)}})},getKey:function(f){return this.children(".keys").children("span").eq(f).text()},getUrl:function(){var f=a[this.attr("id")].url;return f||this.children(".keys").attr("title")},getRow:function(f){var g=a[this.attr("id")].tableClass;return this.find("."+g).children("tbody").children("tr").eq(f).children()},getColumn:function(f){var g=a[this.attr("id")].tableClass;return this.find("."+g).children("tbody").children("tr").children("td:nth-child("+(f+1)+")")},update:function(g){var f;if(g&&g.error!==undefined){f=g.error;delete g.error}return this.each(function(){var i,h=e(this),k=h.attr("id"),j=a[k];g=e.extend({type:j.ajaxType,url:h.yiiGridView("getUrl"),success:function(m){var l=e("<div>"+m+"</div>");e.each(j.ajaxUpdate,function(n,p){var o="#"+p;e(o).replaceWith(e(o,l))});if(j.afterAjaxUpdate!==undefined){j.afterAjaxUpdate(k,m)}if(j.selectableRows>0){d(k)}},complete:function(){c[k]=null;h.removeClass(j.loadingClass)},error:function(n,p,o){var l,m;if(n.readyState===0||n.status===0){return}if(f!==undefined){l=f(n);if(l!==undefined&&!l){return}}switch(p){case"timeout":m="The request timed out!";break;case"parsererror":m="Parser error!";break;case"error":if(n.status&&!/^\s*$/.test(n.status)){m="Error "+n.status}else{m="Error"}if(n.responseText&&!/^\s*$/.test(n.responseText)){m=m+": "+n.responseText}break}if(j.ajaxUpdateError!==undefined){j.ajaxUpdateError(n,p,o,m,k)}else{if(m){alert(m)}}}},g||{});if(g.type==="GET"){if(g.data!==undefined){g.url=e.param.querystring(g.url,g.data);g.data={}}}else{if(g.data===undefined){g.data={};e.each(e(j.filterSelector).serializeArray(),function(){g.data[this.name]=this.value})}}if(j.csrfTokenName&&j.csrfToken){if(typeof g.data=="string"){g.data+="&"+j.csrfTokenName+"="+j.csrfToken}else{g.data[j.csrfTokenName]=j.csrfToken}}if(c[k]!=null){c[k].abort()}h.addClass(j.loadingClass);if(j.ajaxUpdate!==false){if(j.ajaxVar){g.url=e.param.querystring(g.url,j.ajaxVar+"="+k)}if(j.beforeAjaxUpdate!==undefined){j.beforeAjaxUpdate(k,g)}c[k]=e.ajax(g)}else{if(g.type==="GET"){window.location.href=g.url}else{i=e('<form action="'+g.url+'" method="post"></form>').appendTo("body");if(g.data===undefined){g.data={}}if(g.data.returnUrl===undefined){g.data.returnUrl=window.location.href}e.each(g.data,function(l,m){i.append(e('<input type="hidden" name="t" value="" />').attr("name",l).val(m))});i.submit()}}})},getSelection:function(){var g=a[this.attr("id")],h=this.find(".keys span"),f=[];this.find("."+g.tableClass).children("tbody").children().each(function(j){if(e(this).hasClass("selected")){f.push(h.eq(j).text())}});return f},getChecked:function(f){var g=a[this.attr("id")],i=this.find(".keys span"),h=[];if(f.substring(f.length-2)!=="[]"){f=f+"[]"}this.find("."+g.tableClass).children("tbody").children("tr").children("td").children('input[name="'+f+'"]').each(function(j){if(this.checked){h.push(i.eq(j).text())}});return h}};e.fn.yiiGridView=function(f){if(b[f]){return b[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return b.init.apply(this,arguments)}else{e.error("Method "+f+" does not exist on jQuery.yiiGridView");return false}}};e.fn.yiiGridView.settings=a;e.fn.yiiGridView.getKey=function(g,f){return e("#"+g).yiiGridView("getKey",f)};e.fn.yiiGridView.getUrl=function(f){return e("#"+f).yiiGridView("getUrl")};e.fn.yiiGridView.getRow=function(g,f){return e("#"+g).yiiGridView("getRow",f)};e.fn.yiiGridView.getColumn=function(g,f){return e("#"+g).yiiGridView("getColumn",f)};e.fn.yiiGridView.update=function(g,f){e("#"+g).yiiGridView("update",f)};e.fn.yiiGridView.getSelection=function(f){return e("#"+f).yiiGridView("getSelection")};e.fn.yiiGridView.getChecked=function(g,f){return e("#"+g).yiiGridView("getChecked",f)}})(jQuery);